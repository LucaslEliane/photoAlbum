!function(t){"use strict";function e(){this.LAYOUT={PUZZLE:1,WATERFALL:2,BARREL:3},this.init()}var n,i,a,r,o,l,s,d,u=[],c=[],p=[],m=5;e.prototype.init=function(){this.getAlbumElement(),this.createOverlay(),this.getLayout()},e.prototype.getAlbumElement=function(){var e,n;document.getElementsByClassName&&document.getElementsByClassName("lucas-album")[0]&&(a=document.getElementsByClassName("lucas-album")[0],i=parseInt(t.getComputedStyle(a,null).width)),document.querySelectorAll&&0!==document.querySelectorAll(".lucas-album img").length&&(e=document.querySelectorAll(".lucas-album img"));for(var l=0;l<e.length;l++)u[l]=e[l].getAttribute("src"),c[l]={height:t.getComputedStyle(e[l],null).height,width:t.getComputedStyle(e[l],null).width},n=parseInt(c[l].width)/parseInt(c[l].height),p[l]={id:l,ratio:parseFloat(n.toFixed(3))},a.removeChild(e[l]);return o=this.LAYOUT[a.getAttribute("category")],r=u.length,a},e.prototype.getLayout=function(){if(n)return n;switch(o){case 1:n=new f(this,r),n.init();break;case 2:n=new h(this,m),n.init();break;case 3:n=new g(this,i,4),n.init();break;default:n=new h(this,m),n.init()}},e.prototype.addImage=function(t){n.addImage(t)},e.prototype.addClass=function(t,e){var n,i="";return t.getAttribute("class")?(n=t.getAttribute("class").split(" "),n.forEach(function(t){t!==e&&(i=i+" "+t)}),i=i.trim(),i=i+" "+e,t.setAttribute("class",i)):t.setAttribute("class",e),t},e.prototype.removeClass=function(t,e){var n;return t.getAttribute("class")&&(n=t.getAttribute("class"),n=n.replace(e,""),t.setAttribute("class",n)),t},e.prototype.insertAt=function(t,e,n){if(0>n||n>t.childNodes.length)throw new Error("invalid index");return n==t.childNodes.length?t.appendChild(e):t.insertBefore(e,t.childNodes[n]),t},e.prototype.createOverlay=function(){var t=this;l=document.createElement("div"),l.setAttribute("class","overlay"),d=document.createElement("div"),d.setAttribute("class","previewImage"),s=document.createElement("img"),s.setAttribute("class","imageHidden"),this.addClass(l,"hidden"),this.addClass(d,"hidden"),this.insertAt(document.getElementsByTagName("body")[0],l,0),this.insertAt(document.getElementsByTagName("body")[0],d,1),d.appendChild(s),d.addEventListener("click",function(){t.removeClass(l,"overlayShow"),t.removeClass(d,"previewShow"),t.removeClass(s,"imageShow"),t.addClass(l,"hidden"),t.addClass(d,"hidden"),t.addClass(s,"imageHidden")})},e.prototype.addClickEvent=function(t,e){var n,i=this;n=e?e:t.getAttribute("src"),t.addEventListener("click",function(t){s.setAttribute("src",n),i.removeClass(l,"hidden"),i.removeClass(d,"hidden"),i.removeClass(s,"imageHidden"),i.addClass(l,"overlayShow"),i.addClass(d,"previewShow"),i.addClass(s,"imageShow")})};var h=function(t,e){var n=[],i=[];h.prototype.init=function(){this.imageColumn(e),this.initAppendImage()},h.prototype.imageColumn=function(){if(document.createElement)for(var t=0;e>t;t++)i[t]=document.createElement("ul"),i[t].setAttribute("class","waterfall waterfall-"+e),a.appendChild(i[t])},h.prototype.initAppendImage=function(){for(var t=0;e>t;t++)n[t]=0;var i=this;u.forEach(function(t){i.appendImage(t)})},h.prototype.getLowestColumn=function(){for(var t,a=999999,r=0;e>r;r++)n[r]=i[r].offsetHeight;for(var o=0;e>o;o++)n[o]<a&&(t=o,a=n[o]);return t},h.prototype.appendImage=function(e){var n,a,r=this.getLowestColumn();a=document.createElement("li"),n=document.createElement("img"),a.appendChild(n),n.setAttribute("src",e),i[r].appendChild(a),t.addClickEvent(n)},h.prototype.addImage=function(t){var e=this;"string"==typeof t?e.appendImage(t):t.length>1&&t.forEach(function(t){e.appendImage(t)})}},g=function(t,e,n){var i,o,l=0,s=[],d=[];g.prototype.init=function(){for(var t=0;r>t;t++)l+=parseFloat(p[t].ratio),d[t]=t;i=Math.ceil(l/n),this.setRows()},g.prototype.setRows=function(){for(var t=p,l=0;i>l;l++){s[l]=document.createElement("ul"),s[l].setAttribute("class","barrel"),a.appendChild(s[l]),o=0;for(var d=0;r>d;d++)null!==t[d]&&o+t[d].ratio<n&&(this.createImage(t[d].id,l),o+=t[d].ratio,t[d]=null);s[l].style.height=e/o+"px"}},g.prototype.createImage=function(e,n){var i=document.createElement("img");i.setAttribute("src",u[e]),s[n].appendChild(i),t.addClickEvent(i)}},f=function(t,e){var n=[],r=1.5,o=1;f.prototype.init=function(){this.getPuzzleCount()},f.prototype.getPuzzleCount=function(){for(var t=Math.ceil(e/6),l=0;t-1>l;l++){n[l]=document.createElement("div"),n[l].setAttribute("class","puzzle-6"),n[l].style.height=i/1.5+"px",a.appendChild(n[l]);for(var s=0;6>s;s++)this.puzzleCountHelp(l,l,s,r)}n[t]=document.createElement("div"),n[t].setAttribute("class","puzzle-"+e%6),n[t].style.height=i/1.5+"px",a.appendChild(n[t]);for(var d=0;e%6>d;d++)e%6!==2&&(e%6!==5&&e%6!==3||1!==d&&2!==d)?this.puzzleCountHelp(t,t-1,d,r):this.puzzleCountHelp(t,t-1,d,o)},f.prototype.puzzleCountHelp=function(e,i,a,r){var o,l;o=document.createElement("div"),l=p[6*i+a].ratio>=r?"horizontal":"vertical",o.style.backgroundImage='url("'+u[6*i+a]+'")',o.setAttribute("class",l),t.addClickEvent(o,u[6*i+a]),n[e].appendChild(o)}};t.onload=function(){"undefined"==typeof t.lucasAlbum&&(t.lucasAlbum=new e)}}(window);