!function(e){"use strict";function t(){this.LAYOUT={PUZZLE:1,WATERFALL:2,BARREL:3},this.init()}var i,n,a,o,r,l,s,d,u=[],c=[],p=[],m=5;t.prototype.init=function(){switch(this.getAlbumElement(),this.createOverlay(),r){case 1:i=new v(this,o),i.init();break;case 2:i=new h(this,m),i.init();break;case 3:i=new g(this,n,4),i.init();break;default:i=new h(this,m),i.init()}},t.prototype.getAlbumElement=function(){var t,i;document.getElementsByClassName&&document.getElementsByClassName("lucas-album")[0]&&(a=document.getElementsByClassName("lucas-album")[0],n=parseInt(e.getComputedStyle(a,null).width)),document.querySelectorAll&&0!==document.querySelectorAll(".lucas-album img").length&&(t=document.querySelectorAll(".lucas-album img"));for(var l=0;l<t.length;l++)u[l]=t[l].getAttribute("src"),c[l]={height:e.getComputedStyle(t[l],null).height,width:e.getComputedStyle(t[l],null).width},i=parseInt(c[l].width)/parseInt(c[l].height),p[l]={id:l,ratio:parseFloat(i.toFixed(3))},a.removeChild(t[l]);r=this.LAYOUT[a.getAttribute("category")],o=u.length},t.prototype.addClass=function(e,t){var i,n="";e.getAttribute("class")?(i=e.getAttribute("class").split(" "),i.forEach(function(e){e!==t&&(n=n+" "+e)}),n=n.trim(),n=n+" "+t,e.setAttribute("class",n)):e.setAttribute("class",t)},t.prototype.removeClass=function(e,t){var i;e.getAttribute("class")&&(i=e.getAttribute("class"),i=i.replace(t,""),e.setAttribute("class",i))},t.prototype.insertAt=function(e,t,i){if(0>i||i>e.childNodes.length)throw new Error("invalid index");i==e.childNodes.length?e.appendChild(t):e.insertBefore(t,e.childNodes[i])},t.prototype.createOverlay=function(){var e=this;l=document.createElement("div"),l.setAttribute("class","overlay"),d=document.createElement("div"),d.setAttribute("class","previewImage"),s=document.createElement("img"),s.setAttribute("class","imageHidden"),this.addClass(l,"hidden"),this.addClass(d,"hidden"),this.insertAt(document.getElementsByTagName("body")[0],l,0),this.insertAt(document.getElementsByTagName("body")[0],d,1),d.appendChild(s),d.addEventListener("click",function(){e.removeClass(l,"overlayShow"),e.removeClass(d,"previewShow"),e.removeClass(s,"imageShow"),e.addClass(l,"hidden"),e.addClass(d,"hidden"),e.addClass(s,"imageHidden")})},t.prototype.addClickEvent=function(e,t){var i,n=this;i=t?t:e.getAttribute("src"),e.addEventListener("click",function(e){s.setAttribute("src",i),n.removeClass(l,"hidden"),n.removeClass(d,"hidden"),n.removeClass(s,"imageHidden"),n.addClass(l,"overlayShow"),n.addClass(d,"previewShow"),n.addClass(s,"imageShow")})};var h=function(e,t){var i=[],n=[];h.prototype.init=function(){this.imageColumn(t),this.initAppendImage()},h.prototype.imageColumn=function(){if(document.createElement)for(var e=0;t>e;e++)n[e]=document.createElement("ul"),n[e].setAttribute("class","waterfall waterfall-"+t),a.appendChild(n[e])},h.prototype.initAppendImage=function(){for(var e=0;t>e;e++)i[e]=0;var n=this;u.forEach(function(e){n.appendImage(e)})},h.prototype.getLowestColumn=function(){for(var e,a=999999,o=0;t>o;o++)i[o]=n[o].offsetHeight;for(var r=0;t>r;r++)i[r]<a&&(e=r,a=i[r]);return e},h.prototype.appendImage=function(t){var i,a,o=this.getLowestColumn();a=document.createElement("li"),i=document.createElement("img"),a.appendChild(i),i.setAttribute("src",t),n[o].appendChild(a),e.addClickEvent(i)}},g=function(e,t,i){var n,r=0,l=[],s=[];g.prototype.init=function(){for(var e=0;o>e;e++)r+=parseFloat(p[e].ratio),s[e]=e;n=Math.ceil(r/i),this.setRows()},g.prototype.setRows=function(){for(var e,r=p,s=0;n>s;s++){l[s]=document.createElement("ul"),l[s].setAttribute("class","barrel"),a.appendChild(l[s]),e=0;for(var d=0;o>d;d++)null!==r[d]&&e+r[d].ratio<i&&(this.createImage(r[d].id,s),e+=r[d].ratio,r[d]=null);l[s].style.height=t/e+"px"}},g.prototype.createImage=function(t,i){var n=document.createElement("img");n.setAttribute("src",u[t]),l[i].appendChild(n),e.addClickEvent(n)}},v=function(e,t){var i=[],n=1.5,o=1;v.prototype.init=function(){this.getPuzzleCount()},v.prototype.getPuzzleCount=function(){for(var e=Math.ceil(t/6),r=0;e-1>r;r++){i[r]=document.createElement("div"),i[r].setAttribute("class","puzzle-6"),a.appendChild(i[r]);for(var l=0;6>l;l++)this.puzzleCountHelp(r,r,l,n)}i[e]=document.createElement("div"),i[e].setAttribute("class","puzzle-"+t%6),a.appendChild(i[e]);for(var s=0;t%6>s;s++)t%6!==2&&(t%6!==5&&t%6!==3||1!==s&&2!==s)?this.puzzleCountHelp(e,e-1,s,n):this.puzzleCountHelp(e,e-1,s,o)},v.prototype.puzzleCountHelp=function(t,n,a,o){var r,l;r=document.createElement("div"),l=p[6*n+a].ratio>=o?"horizontal":"vertical",r.style.backgroundImage='url("'+u[6*n+a]+'")',r.setAttribute("class",l),e.addClickEvent(r,u[6*n+a]),i[t].appendChild(r)}};e.onload=function(){"undefined"==typeof e.lucasAlbum&&(e.lucasAlbum=new t)}}(window);